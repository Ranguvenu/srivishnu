function _defineProperty(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}define ("local_curriculum/program",["core/str","core/modal_factory","core/modal_events","core/ajax","jquery","jqueryui"],function(a,b,c,d,f){var g;return g={init:function init(a){this.AssignUsers(a)},curriculumDatatable:function curriculumDatatable(a){var b;console.log(a);params=[];params.action="viewcurriculums";params.curriculumstatus=a.curriculumstatus;f("#viewcurriculums").dataTable((b={bInfo:!1,processing:!0,serverSide:!0,ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params}},_defineProperty(b,"bInfo",!1),_defineProperty(b,"bLengthChange",!1),_defineProperty(b,"language",{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>"}),_defineProperty(b,"pageLength",6),b))},SessionDatatable:function SessionDatatable(a){params=[];params.action="viewcurriculumsessions";params.curriculumid=a.curriculumid;params.semesterid=a.semesterid;params.bclcid=a.bclcid;if(""!=a.action){params.tab=a.action}else{params.tab=!1}f("#viewcurriculumsessions").dataTable({processing:!0,serverSide:!0,language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1});this.sessionenrol(a)},deleteConfirm:function deleteConfirm(f){console.log(f);return a.get_strings([{key:"confirmation",component:"local_curriculum"},{key:"deleteconfirm",component:"local_curriculum",param:f.curriculumname},{key:"deleteallconfirm",component:"local_curriculum"},{key:"Delete"},{key:"deletecourseconfirm",component:"local_curriculum"},{key:"cannotdeleteall",component:"local_curriculum"},{key:"cannotdeletesession",component:"local_curriculum"},{key:"cannotdeletesemester",component:"local_curriculum"},{key:"cannotdeletesemesteryear",component:"local_curriculum"},{key:"confirmunassignfaculty",component:"local_curriculum"}]).then(function(a){if("deletecurriculum"==f.action){a[1]=a[1];var e=b.types.CONFIRM}else if("deletecurriculumcourse"==f.action){a[1]=a[4];var e=b.types.CONFIRM}else if("cannotdeletecurriculum"==f.action){a[1]=a[5];var e=b.types.DEFAULT}else if("cannotdeletesession"==f.action){a[1]=a[6];var e=b.types.DEFAULT}else if("cannotdeletesemester"==f.action){a[1]=a[7];var e=b.types.DEFAULT}else if("cannotdeletesemesteryear"==f.action){a[1]=a[8];var e=b.types.DEFAULT}else if("unassignfaculty"==f.action){a[1]=a[9];var e=b.types.CONFIRM}else{a[1]=a[2];var e=b.types.CONFIRM}b.create({title:a[0],type:e,body:a[1]}).done(function(b){this.modal=b;if("cannotdeletecurriculum"!=f.action&&"cannotdeletesession"!=f.action&&"cannotdeletesemester"!=f.action&&"cannotdeletesemesteryear"!=f.action){b.setSaveButtonText(a[3])}b.getRoot().on(c.yes,function(a){a.preventDefault();f.confirm=!0;var b=d.call([{methodname:"local_curriculum_"+f.action,args:f}]);b[0].done(function(){if("deleteprogram"==f.action){window.location.href=M.cfg.wwwroot+"/local/curriculum/index.php"}else{window.location.href=M.cfg.wwwroot+"/local/curriculum/view.php?ccid="+f.curriculumid}}).fail(function(a){console.log(a)})}.bind(this));b.show()}.bind(this))}.bind(this))},AssignUsers:function AssignUsers(){f(".usersselect").click(function(){var a=f(this).data("id");if("removeselect"===a){f("input#remove").prop("disabled",!1);f("input#add").prop("disabled",!0)}else if("addselect"===a){f("input#remove").prop("disabled",!0);f("input#add").prop("disabled",!1)}if(f(this).hasClass("select_all")){f("#"+a+" option").prop("selected",!0)}else if(f(this).hasClass("remove_all")){f("#"+a).val("").trigger("change")}})},curriculumStatus:function curriculumStatus(f){return a.get_strings([{key:"confirmation",component:"local_program"},{key:f.actionstatusmsg,component:"local_program"},{key:"Confirm"}]).then(function(a){b.create({title:a[0],type:b.types.CONFIRM,body:a[1]}).done(function(b){this.modal=b;b.setSaveButtonText(a[2]);b.getRoot().on(c.yes,function(a){a.preventDefault();f.confirm=!0;var b=d.call([{methodname:"local_curriculum_"+f.action,args:f}]);b[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));b.show()}.bind(this))}.bind(this))},ManagecurriculumStatus:function ManagecurriculumStatus(f){return a.get_strings([{key:"confirmation",component:"local_program"},{key:f.actionstatusmsg,component:"local_program",param:f.curriculumname},{key:"deleteallconfirm",component:"local_program"},{key:"yes"}]).then(function(a){b.create({title:a[0],type:b.types.CONFIRM,body:a[1]}).done(function(b){this.modal=b;b.setSaveButtonText(a[3]);b.getRoot().on(c.yes,function(a){a.preventDefault();f.confirm=!0;var b=d.call([{methodname:"local_program_managecurriculumStatus",args:f}]);b[0].done(function(){window.location.href=M.cfg.wwwroot+"/local/curriculum/view.php?ccid="+f.curriculumid}).fail(function(a){console.log(a)})}.bind(this));b.show()}.bind(this))}.bind(this))},load:function load(){},unassignCourses:function unassignCourses(f){return a.get_strings([{key:"confirm"},{key:"unassign_courses_confirm",component:"local_program",param:f},{key:"unassign",component:"local_program"},{key:"cannotunassign_courses_confirm",component:"local_program"}]).then(function(a){if("unassign_course"==f.action){a[1]=a[1];var e=b.types.CONFIRM}else if("cannotunassign_course"==f.action){a[1]=a[3];var e=b.types.DEFAULT}else{a[1]=a[1];var e=b.types.CONFIRM}b.create({title:a[0],type:e,body:a[1]}).done(function(b){this.modal=b;if("cannotunassign_course"!=f.action){b.setSaveButtonText(a[2])}b.getRoot().on(c.yes,function(a){a.preventDefault();params={};params.programid=f.programid;params.curriculumid=f.curriculumid;params.semesterid=f.semesterid;params.yearid=f.yearid;params.courseid=f.courseid;var b=d.call([{methodname:"local_program_"+f.action,args:params}]);b[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));b.show()}.bind(this));modal.show()}.bind(this))},ProgramsDatatable:function ProgramsDatatable(a){params=[];params.action="viewcurriculumprograms";params.type=a.type;params.options=a.options;var b=[],c=f("#viewcurriculumprograms").DataTable({processing:!0,serverSide:!0,ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>"},order:[[1,"asc"]],rowCallback:function rowCallback(c,d){var e=d[0];if(-1!==f.inArray(e,b)&&1==a.type){f(c).find("input[type=\"checkbox\"]").prop("checked",!0);f(c).addClass("selected")}},pageLength:10});if(1==a.type){f("#viewcurriculumprograms tbody").on("click",".programcheckbox",function(a){var d=f(this).closest("tr"),e=c.row(d).data(),h=e[0],i=f.inArray(h,b);if(this.checked&&-1===i){b.push(h)}else if(!this.checked&&-1!==i){b.splice(i,1)}if(this.checked){d.addClass("selected")}else{d.removeClass("selected")}g.updateDataTableSelectAllCtrl(c);a.stopPropagation()});f("#viewcurriculumprograms").on("click","tbody td .programcheckbox, thead th .programcheckboxhead",function(){f(this).parent().find("input[type=\"checkbox\"]").trigger("click")});f("thead input[name=\"select_all\"]",c.table().container()).on("click",function(a){if(this.checked){f("#viewcurriculumprograms tbody input[type=\"checkbox\"]:not(:checked)").trigger("click")}else{f("#viewcurriculumprograms tbody input[type=\"checkbox\"]:checked").trigger("click")}a.stopPropagation()});c.on("draw",function(){g.updateDataTableSelectAllCtrl(c)})}},updateDataTableSelectAllCtrl:function updateDataTableSelectAllCtrl(a){var b=a.table().node(),c=f("tbody input[type=\"checkbox\"]",b),d=f("tbody input[type=\"checkbox\"]:checked",b),e=f("thead input[name=\"select_all\"]",b).get(0);if(0===d.length){e.checked=!1;if("indeterminate"in e){e.indeterminate=!1}}else if(d.length===c.length){e.checked=!0;if("indeterminate"in e){e.indeterminate=!1}}else{e.checked=!0;if("indeterminate"in e){e.indeterminate=!0}}},FacultysDatatable:function FacultysDatatable(){params=[];params.action="viewcoursefaculty";params.yearid=f("#viewcoursefaculty").data("yearid");params.semesterid=f("#viewcoursefaculty").data("semesterid");params.courseid=f("#viewcoursefaculty").data("courseid");f("#viewcoursefaculty").dataTable({processing:!0,serverSide:!0,language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/curriculum/ajax.php",data:params},responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1})},masterprogramchildpopup:function masterprogramchildpopup(a){f.ajax({type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:{curriculumid:a.id,action:"masterprogramchildpopup",sesskey:M.cfg.sesskey},success:function success(d){b.create({title:a.title,body:d}).done(function(b){b.show();g.chlidprogramsDatatable(a);b.setLarge();b.getRoot().addClass("openLMStransition");b.getRoot().animate({right:"0%"},500);b.getRoot().on(c.hidden,function(){b.destroy()}.bind(this));f(".close").click(function(){b.hide();b.destroy()})})}})},chlidprogramsDatatable:function chlidprogramsDatatable(a){params=[];params.action="masterprogramchildpopup";params.curriculumid=a.id;params.stable=0;f("#chlidprograms").dataTable({processing:!0,serverSide:!0,language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1})},checkProgramStatus:function checkProgramStatus(d){f.ajax({type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:{programid:d.pid,curriculumid:d.ccid,costcenter:d.costcenter,action:"programstatusvalidation",sesskey:M.cfg.sesskey},success:function success(e){if("true"==e.finalstatus){b.create({title:"Confirm",type:b.types.SAVE_CANCEL,body:a.get_string("publishprogramconfirmationmessage","local_program",d.programname)}).done(function(a){this.modal=a;a.setSaveButtonText("Confirm");a.getRoot().on(c.yes,function(g){a.hide();a.destroy();g.preventDefault();d.confirm=!0;f.ajax({type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:{programid:d.pid,curriculumid:d.ccid,costcenter:d.costcenter,action:"publishprogram",sesskey:M.cfg.sesskey},success:function success(a){b.create({title:"Success!",body:a}).done(function(a){a.show();a.getRoot().on(c.hidden,function(){setTimeout(function(){a.destroy()},4e3)}.bind(this));f(".close").click(function(){a.hide();a.destroy()});document.location.reload()})}})}.bind(this));a.show()}.bind(this))}else{b.create({type:b.types.CANCEL,title:"Alert!",body:e.message}).done(function(a){a.show();a.getRoot().on(c.hidden,function(){a.destroy()}.bind(this));f(".close").click(function(){a.hide();a.destroy()})})}}})}}});
//# sourceMappingURL=program.min.js.map
