{"version":3,"sources":["../src/courseallocation.js"],"names":["define","dataTable","Str","ModalFactory","ModalEvents","Ajax","$","init","prop","teamsearch","params","searchtype","search","searchvalue","user","val","target","selectedcontent","ajax","type","url","M","cfg","wwwroot","success","data","html","selecteduser","learningtype","learningtype_search","select_type","pluginname","selected_user","create","title","get_string","types","DEFAULT","body","done","modal","show","getRoot","on","hidden","destroy","cancel","datatype","select_list","courseid","courses","coursecheckedstatus","element","checked","current_courses","selected_courses","allocate","allocator","allocateuser","allocatecourse","each","courseid_selected","push","length","SAVE_CANCEL","save","hide","console","log","window","location","href","setTimeout"],"mappings":"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","sourcesContent":["/**\r\n * Add a create new group modal to the page.\r\n *\r\n * @module     core_group/AjaxForms\r\n * @class      AjaxForms\r\n * @package    core_group\r\n * @copyright  2017 Damyon Wiese <damyon@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine([\r\n    'local_users/jquery.dataTables',\r\n    'core/str',\r\n    'core/modal_factory',\r\n    'core/modal_events',\r\n    'core/ajax',\r\n    'jquery',\r\n    'jqueryui'\r\n], function(dataTable, Str, ModalFactory, ModalEvents, Ajax, $) {\r\n    var courseallocation;\r\n    return {\r\n        init: function() {\r\n            $('.allocate_button').prop( \"disabled\", true );\r\n            $('.allocation_course_type_btn').prop( \"disabled\", true );\r\n        },\r\n        teamsearch: function(params) {\r\n            var searchtype = params.searchtype;\r\n            var search = params.searchvalue;\r\n            if(typeof(search) == 'undefined'){\r\n                return false;\r\n            }\r\n            var user = $(\"input[name='allocateuser']:checked\").val();\r\n            if(searchtype === 'users'){\r\n                var target = '.departmentusers';\r\n                var selectedcontent = $('#nominate_userslist').val();\r\n                \r\n                $.ajax({\r\n                    type: \"POST\",\r\n                    url: M.cfg.wwwroot + \"/local/users/team_actions/courseallocation_ajax.php?action=searchdata&learningtype=\"+searchtype+'&search='+search,\r\n                    // data: \"action=searchdata&type=\"+type+'&search='+search+'&learningtype='+learningtype+'&selectedcontent='+selectedcontent+'&user='+user,\r\n                    success: function(data) {\r\n                        $(target).html(data);\r\n                    }\r\n                });\r\n            }else{\r\n                var target = '.departmentcourses';\r\n                var selecteduser = $('#nominate_userslist').val();\r\n                var selectedcontent = $('#nominate_courseslist').val();\r\n                var learningtype = $('#learning_type').val();\r\n                var learningtype_search = $('input[name=\"search_learningtypes\"]').val();\r\n                // console.log(searchtype);\r\n                if(searchtype != learningtype){\r\n                    searchtype = learningtype;\r\n                }\r\n                if(user == undefined || user == null){\r\n                    var data = '<div class=\"alert alert-danger\">Select a user to proceed.</div>'\r\n                    // Str.get_string(\"select_user_toproceed\", \"local_users\")\r\n                    $(target).html(data);\r\n                }else{\r\n                    $.ajax({\r\n                        type: \"POST\",\r\n                        url: M.cfg.wwwroot + \"/local/users/team_actions/courseallocation_ajax.php?action=searchdata&learningtype=\"+searchtype+'&search='+search+'&user='+selecteduser,\r\n                        // data: \"action=searchdata&type=\"+type+'&search='+search+'&learningtype='+learningtype+'&selectedcontent='+selectedcontent+'&user='+user,\r\n                        success: function(data) {\r\n                            $(target).html(data);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        },\r\n        select_type: function(params) {\r\n            var user = params.user;\r\n            var learningtype = params.learningtype;\r\n            var pluginname = params.pluginname;\r\n\r\n            $('input[name=\"search_learningtypes\"]').val('');\r\n            $('#learning_type').val(params.learningtype);\r\n            \r\n            if(user != null && typeof(user) != undefined){\r\n                $('#nominate_userslist').val(user);\r\n            }\r\n\r\n            var selected_user = $('input[name=\"allocateuser\"]:checked').val();\r\n\r\n            // var selectedcontent = $('#nominate_courseslist').val();\r\n            // var user = $(\"input[name='allocateuser']:checked\").val();\r\n\r\n            if(user == undefined && selected_user == null){\r\n\r\n                ModalFactory.create({\r\n                    title: Str.get_string('warning'),\r\n                    type: ModalFactory.types.DEFAULT,\r\n                    body: Str.get_string('team_select_user', 'local_users')\r\n                }).done(function(modal) {\r\n                    // Do what you want with your new modal.\r\n                    modal.show();\r\n                    // modal.setLarge();\r\n                    // modal.getRoot().addClass('openLMStransition');\r\n                    // modal.getRoot().animate({\"right\":\"0%\"}, 500);\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        modal.destroy();\r\n                    });\r\n                    modal.getRoot().on(ModalEvents.cancel, function() {\r\n                        // setTimeout(function(){\r\n                            modal.destroy();\r\n                        // }, 1000);\r\n                    });\r\n                     //return modal;\r\n                });\r\n                // $( \"#coursenominate_confirm\").html(\"Please select Users.\");\r\n                // dlg1 = $( \"#coursenominate_confirm\").dialog({\r\n                //         height: \"auto\",\r\n                //         width: \"auto\",\r\n                //         modal: true,\r\n                //         closeOnEscape: false,\r\n                //         buttons: {\r\n                //             Ok: function () {\r\n                //                 dlg1.dialog(\"close\");\r\n                //             }\r\n                //         }\r\n                // });\r\n                return false;\r\n            }else{\r\n                user = selected_user;\r\n            }\r\n\r\n            switch(learningtype){\r\n                case 1:\r\n                    type = pluginname;\r\n                break;\r\n                case 2:\r\n                    type = pluginname;\r\n                break;\r\n                case 3:\r\n                    type = pluginname;\r\n                break;\r\n                case 4:\r\n                    type = pluginname;\r\n                break;\r\n                default:\r\n                    type = pluginname;\r\n                break;\r\n            }\r\n            $('.allocation_course_type').html(type);\r\n            $.ajax({\r\n                    type: \"GET\",\r\n                    datatype: \"json\",\r\n                    url: M.cfg.wwwroot+\"/local/users/team_actions/courseallocation_ajax.php?action=departmentmodules&learningtype=\" + learningtype+'&user='+user,\r\n                success: function(data) {\r\n                    // data = JSON.parse(data);\r\n                    $(\".departmentcourses\").html(data);\r\n                }\r\n            });\r\n        },\r\n        select_list: function(params) {\r\n            var user = params.user;\r\n            var courseid = params.courses;\r\n            var learningtype = params.learningtype;\r\n            var coursecheckedstatus = params.element.checked;\r\n\r\n            var current_courses = $('#nominate_courseslist').val();\r\n            var selected_courses = $('input[name=\"allocatecourse\"]:checked').val();\r\n            $('input[name=\"search_learningtypes\"]').val('');\r\n            \r\n            var allocate = false;\r\n\r\n            switch(learningtype){\r\n                case 1:\r\n                    if(courseid > 1){\r\n                        if(coursecheckedstatus == true){\r\n                            allocate = true;\r\n                        }\r\n                    }\r\n                break;\r\n                case 2:\r\n                    if(courseid){\r\n                        if(coursecheckedstatus == true){\r\n                            allocate = true;\r\n                        }\r\n                    }\r\n                break;\r\n                case 3:\r\n                    if(courseid > 1){\r\n                        if(coursecheckedstatus == true){\r\n                            allocate = true;\r\n                        }\r\n                    }\r\n                break;\r\n                case 4:\r\n                    if(courseid > 1){\r\n                        if(coursecheckedstatus == true){\r\n                            allocate = true;\r\n                        }\r\n                    }\r\n                break;\r\n                default:\r\n                    allocate = false;\r\n                break;\r\n            }\r\n            \r\n            if(allocate == true){\r\n                $('.allocate_button').prop( \"disabled\", false);\r\n                $('.allocation_course_type_btn').prop( \"disabled\", false);\r\n            }else{\r\n                $('.allocate_button').prop( \"disabled\", true);\r\n                $('.allocation_course_type_btn').prop( \"disabled\", true);\r\n            }\r\n\r\n            switch(learningtype){\r\n                case 1:\r\n                    \r\n                break;\r\n                case 2:\r\n                    \r\n                break;\r\n                case 3:\r\n                    \r\n                break;\r\n                case 4:\r\n                    \r\n                break;\r\n                default:\r\n                    \r\n                break;\r\n            }\r\n        },\r\n        allocator: function() {\r\n            // alert('test');\r\n            // var user = params.user;\r\n            // var learningtype = params.learningtype;\r\n            \r\n            var allocateuser = $('#nominate_userslist').val();\r\n            var learningtype = $('#learning_type').val();\r\n            var allocatecourse = [];\r\n            $('input[name=\"search_learningtypes\"]').val('');\r\n            // var selected_courses = $('input[name=\"allocatecourse[]\"]:checked').val();\r\n             var selected_courses = $('input[name=\"allocatecourse[]\"]:checked').each(function () {\r\n                var courseid_selected = $(this).val();\r\n                allocatecourse.push(courseid_selected);\r\n             });\r\n            \r\n            if(!allocateuser.length){\r\n                ModalFactory.create({\r\n                    title: Str.get_string('warning'),\r\n                    type: ModalFactory.types.DEFAULT,\r\n                    body: Str.get_string('team_select_user', 'local_users')\r\n                }).done(function(modal) {\r\n                    // Do what you want with your new modal.\r\n                    modal.show();\r\n                    // modal.setLarge();\r\n                    // modal.getRoot().addClass('openLMStransition');\r\n                    // modal.getRoot().animate({\"right\":\"0%\"}, 500);\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        modal.destroy();\r\n                    });\r\n                    modal.getRoot().on(ModalEvents.cancel, function() {\r\n                        // setTimeout(function(){\r\n                            modal.destroy();\r\n                        // }, 1000);\r\n                    });\r\n                });\r\n                return false;\r\n            }\r\n            if(!allocatecourse.length){\r\n\r\n\r\n                ModalFactory.create({\r\n                    title: Str.get_string('warning'),\r\n                    type: ModalFactory.types.DEFAULT,\r\n                    body: Str.get_string('team_select_course_s', 'local_users')\r\n                }).done(function(modal) {\r\n                    // Do what you want with your new modal.\r\n                    modal.show();\r\n                    // modal.setLarge();\r\n                    // modal.getRoot().addClass('openLMStransition');\r\n                    // modal.getRoot().animate({\"right\":\"0%\"}, 500);\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        modal.destroy();\r\n                    });\r\n                    modal.getRoot().on(ModalEvents.cancel, function() {\r\n                        // setTimeout(function(){\r\n                            modal.destroy();\r\n                        // }, 1000);\r\n                    });\r\n                });\r\n                return false;\r\n            }\r\n\r\n            ModalFactory.create({\r\n                title: Str.get_string('team_confirm_selected_allocation', 'local_users'),\r\n                type: ModalFactory.types.SAVE_CANCEL,\r\n                body: Str.get_string('allocate_confirm_allocate', 'local_users')\r\n            }).done(function(modal) {\r\n                // Do what you want with your new modal.\r\n                modal.show();\r\n                // modal.setLarge();\r\n                // modal.getRoot().addClass('openLMStransition');\r\n                // modal.getRoot().animate({\"right\":\"0%\"}, 500);\r\n                modal.getRoot().on(ModalEvents.hidden, function() {\r\n                    modal.destroy();\r\n                });\r\n                modal.getRoot().on(ModalEvents.save, function() {\r\n                    $.ajax({\r\n                            type: \"post\",\r\n                            url: M.cfg.wwwroot + \"/local/users/team_actions/courseallocation_ajax.php?action=courseallocate&learningtype=\"+learningtype+\"&user=\"+allocateuser+\"&allocatecourse=\"+allocatecourse,\r\n                            success: function (data) {\r\n                                // console.log(data);\r\n                                // dlg3.dialog(\"close\");\r\n                                $('#allocation_notifications').html('<div class=\"alert alert-info\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>Selected learning types has been allocated.</div>');\r\n                                modal.hide();\r\n                                // setTimeout(function(){\r\n                                    modal.destroy();\r\n                                    console.log(data);\r\n                                    window.location.href = window.location.href;\r\n                                // }, 5000);\r\n                            }\r\n                        });\r\n                });\r\n                modal.getRoot().on(ModalEvents.cancel, function() {\r\n                    setTimeout(function(){\r\n                        modal.destroy();\r\n                    }, 1000);\r\n                });\r\n                 //return modal;\r\n            });\r\n        }\r\n\r\n    };\r\n});"],"file":"courseallocation.min.js"}