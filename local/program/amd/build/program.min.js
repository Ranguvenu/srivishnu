function _defineProperty(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}define ("local_program/program",["local_program/dataTables.checkboxes","core/str","core/modal_factory","core/modal_events","core/ajax","jquery","jqueryui"],function(a,b,c,d,f,g){var e;return e={init:function init(a){this.AssignUsers(a)},curriculumDatatable:function curriculumDatatable(a){var b;params=[];params.action="viewcurriculums";params.curriculumstatus=a.curriculumstatus;g("#viewcurriculums").dataTable((b={bInfo:!1,processing:!0,serverSide:!0,ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params}},_defineProperty(b,"bInfo",!1),_defineProperty(b,"bLengthChange",!1),_defineProperty(b,"language",{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>"}),_defineProperty(b,"pageLength",6),b))},SessionDatatable:function SessionDatatable(a){params=[];params.action="viewcurriculumsessions";params.curriculumid=a.curriculumid;params.semesterid=a.semesterid;params.bclcid=a.bclcid;params.ccses_action=a.ccses_action;params.programid=a.programid;params.yearid=a.yearid;params.courseid=a.courseid;if(""!=a.action){params.tab=a.action}else{params.tab=!1}g("#viewcurriculumsessions").dataTable({processing:!0,serverSide:!0,language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1});this.sessionenrol(a)},sessionenrol:function sessionenrol(a){g(document).on("click",".sessionenrol",function(){var h=g(this).data();return b.get_strings([{key:"confirmation",component:"local_program"},{key:"confirmschedulesession",component:"local_program"},{key:"confirmreschedulesession",component:"local_program"},{key:"confirmcancelsession",component:"local_program"},{key:"yes"}]).then(function(b){console.log(b);var e=b[1];if(2==h.enrol){e=b[2]}else if(3==h.enrol){e=b[3]}c.create({title:b[0],type:c.types.SAVE_CANCEL,body:e}).done(function(c){this.modal=c;c.setSaveButtonText(b[4]);c.getRoot().on(d.save,function(b){b.preventDefault();a.confirm=!0;var c=f.call([{methodname:"local_program_session_enrolments",args:h}]);c[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));c.show()}.bind(this))}.bind(this))})},CoursesDatatable:function CoursesDatatable(){params=[];params.action="viewcurriculumcourses";params.curriculumid=g("#viewcurriculumcourses").data("curriculumid");g("#viewcurriculumcourses").dataTable({processing:!0,language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:10})},UsersDatatable:function UsersDatatable(){params=[];params.action="viewcurriculumusers";params.curriculumid=g("#viewcurriculumusers").data("curriculumid");params.yearid=g("#viewcurriculumusers").data("yearid");g("#viewcurriculumusers").dataTable({processing:!0,serverSide:!0,language:{emptyTable:"No Users Enrolled to this program",paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:10})},ProgramDatatable:function ProgramDatatable(){params=[];params.action="viewprogramenrolsers";params.curriculumid=g("#viewprogramenrolsers").data("curriculumid");params.yearid=g("#viewprogramenrolsers").data("yearid");g("#viewprogramenrolsers").dataTable({processing:!0,serverSide:!0,language:{emptyTable:"No Users Enrolled to this program",paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:10})},viewinfoConfirm:function viewinfoConfirm(a){c.create({title:a.title,body:a.body,footer:"<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">Cancel</button>"}).done(function(a){a.show();a.getRoot().on(d.hidden,function(){a.destroy()}.bind(this));g("[data-action=\"cancel\"]").on("click",function(){a.hide();a.destroy()})})},deleteConfirm:function deleteConfirm(a){return b.get_strings([{key:"confirmation",component:"local_program"},{key:"deleteconfirm",component:"local_program",param:a.curriculumname},{key:"deleteallconfirm",component:"local_program"},{key:"delete"},{key:"deletecourseconfirm",component:"local_program"},{key:"cannotdeleteall",component:"local_program"},{key:"cannotdeletesession",component:"local_program"},{key:"cannotdeletesemester",component:"local_program"},{key:"cannotdeletesemesteryear",component:"local_program"},{key:"confirmunassignfaculty",component:"local_program"},{key:"confirmunassignuser",component:"local_program"},{key:"confirmcannotunassignuser",component:"local_program"}]).then(function(e){if("deletecurriculum"==a.action){e[1]=e[1];var g=c.types.SAVE_CANCEL}else if("deletecurriculumcourse"==a.action){e[1]=e[4];var g=c.types.SAVE_CANCEL}else if("cannotdeletecurriculum"==a.action){e[1]=e[5];var g=c.types.DEFAULT}else if("cannotdeletesession"==a.action){if(1==a.sessioncount){e[1]=b.get_string("fixedsessionsvalidation","local_program");e[0]="Alert!"}else{e[1]=e[6];e[0]="Alert!"}var g=c.types.CANCEL}else if("cannotdeletesemester"==a.action){e[1]=e[7];var g=c.types.DEFAULT}else if("cannotdeletesemesteryear"==a.action){e[1]=e[8];var g=c.types.DEFAULT}else if("unassignfaculty"==a.action){e[1]=e[9];var g=c.types.SAVE_CANCEL}else if("unassignuser"==a.action){e[1]=e[10];e[3]="Unassign";var g=c.types.SAVE_CANCEL}else if("cannotunassignuser"==a.action){e[1]=e[11];e[0]="Alert!";var g=c.types.CANCEL}else if("deleteclassroom"==a.action){if(0<a.count){var h=a.count,g=c.types.CANCEL;e[1]=b.get_string("offlineclassroomdelvalidation","local_program");e[0]="Alert!"}else{e[1]=b.get_string("deleteclassroomconfirm","local_program",a.classname);var g=c.types.SAVE_CANCEL}}else{e[1]=e[2];var g=c.types.SAVE_CANCEL}c.create({title:e[0],type:g,body:e[1]}).done(function(b){this.modal=b;if("deleteclassroom"==a.action&&0==a.count){b.setSaveButtonText(e[3])}if("deleteclassroom"!=a.action&&"cannotdeletecurriculum"!=a.action&&"cannotdeletesession"!=a.action&&"cannotdeletesemester"!=a.action&&"cannotdeletesemesteryear"!=a.action&&"cannotunassignuser"!=a.action){b.setSaveButtonText(e[3])}b.getRoot().on(d.save,function(b){b.preventDefault();a.confirm=!0;var c=f.call([{methodname:"local_program_"+a.action,args:a}]);c[0].done(function(){if("deleteprogram"==a.action){window.location.href=M.cfg.wwwroot+"/local/program/index.php"}else if("deletesession"==a.action||"unassignfaculty"==a.action){document.location.reload()}else if("unassignuser"==a.action){window.location.href=M.cfg.wwwroot+"/local/program/users.php?ccid="+a.curriculumid+"&prgid="+a.programid+"&yearid="+a.yearid}else{window.location.href=M.cfg.wwwroot+"/local/program/view.php?ccid="+a.curriculumid+"&prgid="+a.programid}}).fail(function(a){console.log(a)})}.bind(this));b.show()}.bind(this))}.bind(this))},AssignUsers:function AssignUsers(){g(".usersselect").click(function(){var a=g(this).data("id");if("removeselect"===a){g("input#remove").prop("disabled",!1);g("input#add").prop("disabled",!0)}else if("addselect"===a){g("input#remove").prop("disabled",!0);g("input#add").prop("disabled",!1)}if(g(this).hasClass("select_all")){g("#"+a+" option").prop("selected",!0)}else if(g(this).hasClass("remove_all")){g("#"+a).val("").trigger("change")}})},curriculumStatus:function curriculumStatus(a){return b.get_strings([{key:"confirmation",component:"local_program"},{key:a.actionstatusmsg,component:"local_program"},{key:"yes"}]).then(function(b){c.create({title:b[0],type:c.types.SAVE_CANCEL,body:b[1]}).done(function(c){this.modal=c;c.setSaveButtonText(b[2]);c.getRoot().on(d.save,function(b){b.preventDefault();a.confirm=!0;var c=f.call([{methodname:"local_curriculum_"+a.action,args:a}]);c[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));c.show()}.bind(this))}.bind(this))},ManagecurriculumStatus:function ManagecurriculumStatus(a){return b.get_strings([{key:"confirmation",component:"local_program"},{key:a.actionstatusmsg,component:"local_program",param:a.curriculumname},{key:"deleteallconfirm",component:"local_program"},{key:"yes"}]).then(function(b){c.create({title:b[0],type:c.types.SAVE_CANCEL,body:b[1]}).done(function(c){this.modal=c;c.setSaveButtonText(b[3]);c.getRoot().on(d.save,function(b){b.preventDefault();a.confirm=!0;var c=f.call([{methodname:"local_program_managecurriculumStatus",args:a}]);c[0].done(function(){window.location.href=M.cfg.wwwroot+"/local/program/view.php?ccid="+a.curriculumid}).fail(function(a){console.log(a)})}.bind(this));c.show()}.bind(this))}.bind(this))},load:function load(){},unassignCourses:function unassignCourses(a){return b.get_strings([{key:"confirm"},{key:"unassign_courses_confirm",component:"local_program",param:a},{key:"unassign",component:"local_program"},{key:"cannotunassign_courses_confirm",component:"local_program"}]).then(function(b){if("unassign_course"==a.action){b[1]=b[1];var e=c.types.SAVE_CANCEL}else if("cannotunassign_course"==a.action){b[1]=b[3];var e=c.types.DEFAULT}else{b[1]=b[1];var e=c.types.SAVE_CANCEL}c.create({title:b[0],type:e,body:b[1]}).done(function(c){this.modal=c;if("cannotunassign_course"!=a.action){c.setSaveButtonText(b[2])}c.getRoot().on(d.save,function(b){b.preventDefault();params={};params.programid=a.programid;params.curriculumid=a.curriculumid;params.semesterid=a.semesterid;params.yearid=a.yearid;params.courseid=a.courseid;var c=f.call([{methodname:"local_program_"+a.action,args:params}]);c[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));c.show()}.bind(this));modal.show()}.bind(this))},ProgramsDatatable:function ProgramsDatatable(a){params=[];params.action="viewcurriculumprograms";params.type=a.type;params.options=a.options;g("#viewcurriculumprograms").DataTable({searching:!0,responsive:!0,processing:!0,lengthMenu:[[10,25,50,100,-1],[10,25,50,100,"All"]],language:{emptyTable:"No Programs available in table",paginate:{previous:"<",next:">"},sProcessing:"<img src= "+M.cfg.wwwroot+"/local/ajax-loader.svg />"},aaSorting:[],bServerSide:!0,pageLength:10,ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params}})},updateDataTableSelectAllCtrl:function updateDataTableSelectAllCtrl(a){var b=a.table().node(),c=g("tbody input[type=\"checkbox\"]",b),d=g("tbody input[type=\"checkbox\"]:checked",b),e=g("thead input[name=\"select_all\"]",b).get(0);if(0===d.length){e.checked=!1;if("indeterminate"in e){e.indeterminate=!1}}else if(d.length===c.length){e.checked=!0;if("indeterminate"in e){e.indeterminate=!1}}else{e.checked=!0;if("indeterminate"in e){e.indeterminate=!0}}},FacultysDatatable:function FacultysDatatable(){params=[];params.action="viewcoursefaculty";params.yearid=g("#viewcoursefaculty").data("yearid");params.semesterid=g("#viewcoursefaculty").data("semesterid");params.courseid=g("#viewcoursefaculty").data("courseid");g("#viewcoursefaculty").dataTable({processing:!0,serverSide:!0,language:{emptyTable:"No Faculty Available to this course",paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1})},masterprogramchildpopup:function masterprogramchildpopup(a){g.ajax({type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:{curriculumid:a.id,action:"masterprogramchildpopup",sesskey:M.cfg.sesskey},success:function success(b){c.create({title:a.title,body:b}).done(function(b){b.show();e.chlidprogramsDatatable(a);b.setLarge();b.getRoot().addClass("openLMStransition");b.getRoot().animate({right:"0%"},500);b.getRoot().on(d.hidden,function(){b.destroy()}.bind(this));g(".close").click(function(){b.hide();b.destroy()})})}})},chlidprogramsDatatable:function chlidprogramsDatatable(a){params=[];params.action="masterprogramchildpopup";params.curriculumid=a.id;params.stable=0;g("#chlidprograms").dataTable({processing:!0,serverSide:!0,language:{paginate:{next:">",previous:"<"},processing:"<img src="+M.cfg.wwwroot+"/local/ajax-loader.svg>",search:"",searchPlaceholder:"Search"},ajax:{type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:params},responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1})},programSuspend:function programSuspend(a){return b.get_strings([{key:"confirmation",component:"local_program"},{key:"suspendconfirm",component:"local_program",param:a},{key:"suspendallconfirm",component:"local_program"},{key:"confirm"}]).then(function(b){c.create({title:b[0],type:c.types.SAVE_CANCEL,body:b[1]}).done(function(c){this.modal=c;c.setSaveButtonText(b[3]);c.getRoot().on(d.save,function(b){b.preventDefault();a.confirm=!0;console.log(a);var c={id:a.id,contextid:a.contextid},d=f.call([{methodname:"local_program_suspend_program",args:c}]);d[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));c.show()}.bind(this))}.bind(this))},checkProgramStatus:function checkProgramStatus(a){g.ajax({type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:{programid:a.pid,curriculumid:a.ccid,costcenter:a.costcenter,action:"programstatusvalidation",sesskey:M.cfg.sesskey},success:function success(e){if("true"==e.finalstatus){c.create({title:"Confirm",type:c.types.SAVE_CANCEL,body:b.get_string("publishprogramconfirmationmessage","local_program",a.programname)}).done(function(b){this.modal=b;b.setSaveButtonText("Confirm");b.getRoot().on(d.save,function(c){b.hide();b.destroy();c.preventDefault();a.confirm=!0;g.ajax({type:"POST",url:M.cfg.wwwroot+"/local/program/ajax.php",data:{programid:a.pid,curriculumid:a.ccid,costcenter:a.costcenter,action:"publishprogram",sesskey:M.cfg.sesskey},success:function success(){require(["core/notification"],function(a){a.addNotification({message:"Program published Successfully",type:"success"})});document.body.scrollTop=0;document.documentElement.scrollTop=0;window.setTimeout(function(){document.location.reload()},5e3)}})}.bind(this));b.show()}.bind(this))}else{c.create({type:c.types.CANCEL,title:"Alert!",body:e.message}).done(function(a){a.show();a.getRoot().on(d.hidden,function(){a.destroy()}.bind(this));g(".close").click(function(){a.hide();a.destroy()})})}}})}}});
//# sourceMappingURL=program.min.js.map
