{"version":3,"sources":["../src/newboard.js"],"names":["define","$","Str","ModalFactory","ModalEvents","Fragment","Ajax","Y","Newboard","args","contextid","boardid","self","init","prototype","modal","editid","data","schoolid","head","get_string","then","title","create","type","types","DEFAULT","body","getBody","footer","getFooter","bind","getRoot","addClass","setLarge","on","hidden","destroy","find","submitForm","window","location","href","form_status","callback","setBody","form","submitFormAjax","show","animate","click","formdata","params","jsonformdata","JSON","stringify","loadFragment","console","log","$footer","$style","handleFormSubmissionResponse","hide","use","M","core_formchangechecker","reset_form_dirty_state","document","reload","handleFormSubmissionFailure","e","preventDefault","formData","serialize","call","methodname","done","fail","submit","load","schoolvalue","val","ajax","method","dataType","url","cfg","wwwroot","success","template","each","index","value","id","fullname","html","boardStatus","actionstatus","SAVE_CANCEL","actionstatusmsg","setSaveButtonText","yes","confirm","promise","deleteConfirm","get_strings","key","component","param","s","CONFIRM","boardfaculty","CANCEL","count","save","ex"],"mappings":"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","sourcesContent":["define(['jquery', 'core/str', 'core/modal_factory', 'core/modal_events', 'core/fragment', 'core/ajax', 'core/yui'],\r\n        function($, Str, ModalFactory, ModalEvents, Fragment, Ajax, Y) {\r\n \r\n    var Newboard = function(args) {\r\n        this.contextid = args.contextid;\r\n        this.boardid = args.boardid;\r\n        var self = this;\r\n        self.init(args);\r\n    };\r\n \r\n    /**\r\n     * @var {Modal} modal\r\n     * @private\r\n     */\r\n    Newboard.prototype.modal = null;\r\n    /**\r\n     * @var {int} contextid\r\n     * @private\r\n     */\r\n    Newboard.prototype.contextid = -1;\r\n\r\n    Newboard.prototype.init = function(args) {\r\n        //var triggers = $(selector);\r\n        var self = this;\r\n\r\n            var editid = $(this).data('value');\r\n            if (editid) {\r\n                self.schoolid = editid;\r\n            }\r\n            if(self.boardid){\r\n                var head =  Str.get_string('editboard', 'local_boards');\r\n            }\r\n            else{\r\n               var head = Str.get_string('adnewboard', 'local_boards');\r\n            }\r\n            return head.then(function(title) {\r\n                // Create the modal.\r\n                return ModalFactory.create({\r\n                    type: ModalFactory.types.DEFAULT,\r\n                    title: title,\r\n                    body: self.getBody(),\r\n                    footer: this.getFooter(),\r\n                });\r\n            }.bind(self)).then(function(modal) {\r\n                \r\n                // Keep a reference to the modal.\r\n                self.modal = modal;\r\n               \r\n                self.modal.getRoot().addClass('openLMStransition local_school');\r\n                // Forms are big, we want a big modal.\r\n                self.modal.setLarge();\r\n     \r\n                // We want to reset the form every time it is opened.\r\n                this.modal.getRoot().on(ModalEvents.hidden, function() {\r\n                // this.modal.getRoot().animate({\"right\":\"-85%\"}, 500);\r\n                // setTimeout(function(){\r\n                    modal.destroy();\r\n                // }, 1000);\r\n            }.bind(this));\r\n            this.modal.getFooter().find('[data-action=\"save\"]').on('click', this.submitForm.bind(this));\r\n            this.modal.getFooter().find('[data-action=\"cancel\"]').on('click', function() {\r\n                window.location.href =  window.location.href;\r\n            });\r\n            this.modal.getFooter().find('[data-action=\"skip\"]').on('click', function() {\r\n                self.args.form_status = self.args.form_status + 1;\r\n                 // OL-1042 Add Target Audience to curriculums//\r\n                 if (args.callback == 'program_form') {\r\n                // OL-1042 Add Target Audience to curriculums//\r\n                    // curriculumlastchildpopup(args);\r\n                 }\r\n                var data = self.getBody();\r\n             \r\n                modal.setBody(data);\r\n            });\r\n\r\n            this.modal.getRoot().on('submit', 'form', function(form) {\r\n                self.submitFormAjax(form, self.args);\r\n            });\r\n            this.modal.show();\r\n            this.modal.getRoot().animate({\"right\":\"0%\"}, 500);\r\n            $(\".close\").click(function(){\r\n                window.location.href =  window.location.href;\r\n            });\r\n            return this.modal;\r\n        }.bind(this));\r\n    };\r\n    Newboard.prototype.getBody = function(formdata) {\r\n        if (typeof formdata === \"undefined\") {\r\n            formdata = {};\r\n        }\r\n        // alert(formdata);\r\n        // Get the content of the modal.\r\n        var params = {boardid:this.boardid, jsonformdata: JSON.stringify(formdata)};\r\n        return Fragment.loadFragment('local_boards', 'new_boardform', this.contextid, params);\r\n    };\r\n      Newboard.prototype.getFooter = function() {\r\n        console.log(this);\r\n        if(this.boardid){\r\n             $footer = '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Update</button>&nbsp;';\r\n        }\r\n        else{\r\n        $footer = '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Create</button>&nbsp;';\r\n        }\r\n        if (this.form_status == 0) {\r\n            $style = 'style=\"display:none;\"';\r\n            $footer += '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"skip\" ' + $style + '>Skip</button>&nbsp;';\r\n        }\r\n        $footer += '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">Cancel</button>';\r\n        return $footer;\r\n    };\r\n    /**\r\n     * @method handleFormSubmissionResponse\r\n     * @private\r\n     * @return {Promise}\r\n     */\r\n    Newboard.prototype.handleFormSubmissionResponse = function() {\r\n        this.modal.hide();\r\n        // We could trigger an event instead.\r\n        // Yuk.\r\n        Y.use('moodle-core-formchangechecker', function() {\r\n            M.core_formchangechecker.reset_form_dirty_state();\r\n        });\r\n        document.location.reload();\r\n    };\r\n \r\n    /**\r\n     * @method handleFormSubmissionFailure\r\n     * @private\r\n     * @return {Promise}\r\n     */\r\n    Newboard.prototype.handleFormSubmissionFailure = function(data) {\r\n        // Oh noes! Epic fail :(\r\n        // Ah wait - this is normal. We need to re-display the form with errors!\r\n        this.modal.setBody(this.getBody(data));\r\n    };\r\n \r\n    /**\r\n     * Private method\r\n     *\r\n     * @method submitFormAjax\r\n     * @private\r\n     * @param {Event} e Form submission event.\r\n     */\r\n    Newboard.prototype.submitFormAjax = function(e) {\r\n        // We don't want to do a real form submission.\r\n        e.preventDefault();\r\n \r\n        // Convert all the form elements values to a serialised string.\r\n        var formData = this.modal.getRoot().find('form').serialize();\r\n        // alert(this.contextid);\r\n        // Now we can continue...\r\n        Ajax.call([{\r\n            methodname: 'local_boards_submit_boardform_data',\r\n            args: {contextid: this.contextid, jsonformdata: JSON.stringify(formData)},\r\n            done: this.handleFormSubmissionResponse.bind(this, formData),\r\n            fail: this.handleFormSubmissionFailure.bind(this, formData)\r\n        }]);\r\n    };\r\n \r\n    /**\r\n     * This triggers a form submission, so that any mform elements can do final tricks before the form submission is processed.\r\n     *\r\n     * @method submitForm\r\n     * @param {Event} e Form submission event.\r\n     * @private\r\n     */\r\n    Newboard.prototype.submitForm = function(e) {\r\n        e.preventDefault();\r\n        var self = this;\r\n        self.modal.getRoot().find('form').submit();\r\n    };\r\n\r\n    return /** @alias module:local_school/newschool */ {\r\n                // Public variables and functions.\r\n                /**\r\n                 * Attach event listeners to initialise this module.\r\n                 *\r\n                 * @method init\r\n                 * @param {string} selector The CSS selector used to find nodes that will trigger this module.\r\n                 * @param {int} contextid The contextid for the course.\r\n                 * @return {Promise}\r\n                 */\r\n                init: function(args) {\r\n                  \r\n                    // alert(args.contextid);\r\n                    return new Newboard(args);\r\n                },\r\n                load: function(){\r\n                $(document).on('change', '#id_schoolid', function() {\r\n              var schoolvalue = $(this).find(\"option:selected\").val();\r\n               if (schoolvalue !== null) {\r\n                    $.ajax({\r\n                        method: \"GET\",\r\n                        dataType: \"json\",\r\n                        url: M.cfg.wwwroot + \"/local/boards/ajax.php?action=departmentlist&schoolid=\"+schoolvalue,\r\n                    success: function(data){\r\n                        var template = '<option value=0>Select Departments</option>';\r\n                        $.each( data.data, function( index, value) {\r\n                             template +='<option value = ' + value.id + ' >' +value.fullname + '</option>';\r\n                        });\r\n                      $(\"#id_departmentid\").html(template);\r\n                  }\r\n                    });\r\n                } \r\n            });\r\n                },\r\n            boardStatus: function(args) {\r\n                ModalFactory.create({\r\n                    title: args.actionstatus,\r\n                    type: ModalFactory.types.SAVE_CANCEL,\r\n                    body: args.actionstatusmsg\r\n                }).done(function(modal) {\r\n                    this.modal = modal;\r\n                    modal.setSaveButtonText('Confirm');\r\n                    modal.getRoot().on(ModalEvents.yes, function(e) {\r\n                        e.preventDefault();\r\n                        args.confirm = true;\r\n                        var promise = Ajax.call([{\r\n                            methodname: 'local_boards_suspend_board',\r\n                            args: args\r\n                        }]);\r\n                        promise[0].done(function(resp) {\r\n                            window.location.href = window.location.href;\r\n                        }).fail(function(ex) {\r\n                            // do something with the exception\r\n                        });\r\n                    }.bind(this));\r\n                    modal.show();\r\n                }.bind(this));\r\n        },\r\n    //     deleteConfirm: function(args) {\r\n    //         return Str.get_strings([{\r\n    //             key: 'confirm'\r\n    //         },\r\n    //         {\r\n    //             key: 'deleteconfirm',\r\n    //             component: 'local_boards',\r\n    //             param :args\r\n    //         },\r\n    //         {\r\n    //             key: 'deleteallconfirm',\r\n    //             component: 'local_boards'\r\n    //         },\r\n    //         {\r\n    //             key: 'delete'\r\n    //         }]).then(function(s) {\r\n    //             var type = ModalFactory.types.CONFIRM;\r\n    //             var body = s[1];\r\n    //             var title = Str.get_string('deleteconfirmation', 'local_boards');\r\n    //             if(args['count'] > 0){\r\n    //                 var boardfaculty = args['count'];\r\n    //                 title = 'Alert!';\r\n    //                 type = ModalFactory.types.CANCEL;\r\n    //                 body = Str.get_string('boardfacultyvalidation', 'local_boards', boardfaculty);\r\n    //                 // s[0] = Str.get_string('cannotdeleteboard', 'local_boards');\r\n    //                 s[0] = \"Alert!\";\r\n    //             }\r\n    //             ModalFactory.create({\r\n    //                 title: title,\r\n    //                 type: type,\r\n    //                 body: body\r\n    //             }).done(function(modal) {\r\n    //                 this.modal = modal;\r\n    //                 if(args.count == 0){\r\n    //                 modal.setSaveButtonText(s[3]);\r\n    //                 modal.getRoot().on(ModalEvents.yes, function(e) {\r\n    //                     e.preventDefault();\r\n    //                     args.confirm = true;\r\n    //                     var params = {};\r\n    //                     params.id = args.id;\r\n    //                     params.contextid = args.contextid;\r\n                    \r\n    //                     var promise = Ajax.call([{\r\n    //                         methodname: 'local_boards_delete_board',\r\n    //                         args: params\r\n    //                     }]);\r\n    //                     promise[0].done(function(resp) {\r\n    //                         window.location.href = window.location.href;\r\n    //                     }).fail(function(ex) {\r\n    //                         // do something with the exception\r\n    //                          console.log(ex);\r\n    //                     });\r\n    //                 }.bind(this));\r\n    //                 }\r\n    //                 modal.show();\r\n    //             }.bind(this));\r\n    //         }.bind(this));\r\n    //     },    \r\n    // };\r\n//added revathi\r\n\r\n    deleteConfirm: function(args) {\r\n            return Str.get_strings([{\r\n                key: 'confirm'\r\n            },\r\n            {\r\n                key: 'deleteconfirm',\r\n                component: 'local_boards',\r\n                param :args\r\n            },\r\n            {\r\n                key: 'deleteallconfirm',\r\n                component: 'local_boards'\r\n            },\r\n            {\r\n                key: 'delete'\r\n            }]).then(function(s) {\r\n                var type = ModalFactory.types.CONFIRM;\r\n                var body = s[1];\r\n                var title = Str.get_string('deleteconfirmation', 'local_boards');\r\n                if(args['count'] > 0){\r\n                    var boardfaculty = args['count'];\r\n                    title = 'Alert!';\r\n                    type = ModalFactory.types.CANCEL;\r\n                    body = Str.get_string('boardfacultyvalidation', 'local_boards', boardfaculty);\r\n                    // s[0] = Str.get_string('cannotdeleteboard', 'local_boards');\r\n                    s[0] = \"Alert!\";\r\n                }\r\n                ModalFactory.create({\r\n                    title: s[0],\r\n                    type: ModalFactory.types.SAVE_CANCEL,\r\n                    body: body\r\n                }).done(function(modal) {\r\n                    this.modal = modal;\r\n                    if(args.count == 0){\r\n                    modal.setSaveButtonText(s[3]);\r\n                    modal.getRoot().on(ModalEvents.save, function(e) {\r\n                        e.preventDefault();\r\n                        args.confirm = true;\r\n                        var params = {};\r\n                        params.id = args.id;\r\n                        params.contextid = args.contextid;\r\n                    \r\n                        var promise = Ajax.call([{\r\n                            methodname: 'local_boards_delete_board',\r\n                            args: params\r\n                        }]);\r\n                        promise[0].done(function(resp) {\r\n                            window.location.href = window.location.href;\r\n                        }).fail(function(ex) {\r\n                            // do something with the exception\r\n                             console.log(ex);\r\n                        });\r\n                    }.bind(this));\r\n                    }\r\n                    modal.show();\r\n                }.bind(this));\r\n            }.bind(this));\r\n        },    \r\n    };\r\n    //end added\r\n});"],"file":"newboard.min.js"}