{"version":3,"sources":["../src/newmooccourses.js"],"names":["define","dataTable","$","Str","ModalFactory","ModalEvents","Fragment","Ajax","Y","NewMooccourse","args","contextid","context","id","self","init","prototype","modal","console","log","course","head","get_string","act","then","title","create","type","types","DEFAULT","body","getBody","footer","getFooter","bind","getRoot","addClass","setLarge","on","hidden","destroy","find","submitForm","window","location","href","form_status","data","setBody","form","submitFormAjax","show","animate","click","formdata","JSON","stringify","loadFragment","courseid","$footer","$style","handleFormSubmissionResponse","hide","use","M","core_formchangechecker","reset_form_dirty_state","document","reload","handleFormSubmissionFailure","e","preventDefault","formData","serialize","call","methodname","parentcourseid","jsonformdata","done","fail","forpurchaseindividually","submit","load","costcentervalue","val","ajax","method","dataType","url","cfg","wwwroot","success","template","each","index","value","fullname","html","mooccoursesList","action","sesskey","returndata","cancel","dataTableshow"],"mappings":"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","sourcesContent":["/**\n * Add a create new group modal to the page.\n *\n * @module     local_advisor/advisor\n * @class      NewMooccourse\n * @package    local_advisor\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['local_mooccourses/jquery.dataTables', 'jquery', 'core/str', 'core/modal_factory', 'core/modal_events', 'core/fragment', 'core/ajax', 'core/yui'],\n        function(dataTable, $, Str, ModalFactory, ModalEvents, Fragment, Ajax, Y) {\n \n    /**\n     * Constructor\n     *\n     * @param {String} selector used to find triggers for the new group modal.\n     * @param {int} contextid\n     *\n     * Each call to init gets it's own instance of this class.\n     */\n    var NewMooccourse = function(args) {\n        this.contextid = args.context;\n        this.id = args.id;\n        var self = this;\n        this.args = args;\n        self.init(args);\n    };\n \n    /**\n     * @var {Modal} modal\n     * @private\n     */\n    NewMooccourse.prototype.modal = null;\n \n    /**\n     * @var {int} contextid\n     * @private\n     */\n    NewMooccourse.prototype.contextid = -1;\n \n    /**\n     * Initialise the class.\n     *\n     * @param {String} selector used to find triggers for the new group modal.\n     * @private\n     * @return {Promise}\n     */\n    NewMooccourse.prototype.init = function(args) {\n        console.log(args);\n        var self = this;\n            \n            if (args.course == 2) {\n                var head =  Str.get_string('edituser', 'local_mooccourses');\n            }\n\n            if (args.course == 1) {\n                var head =  Str.get_string('selectcategory', 'local_mooccourses');\n            }\n\n            if (args.course == 3) {\n                var head =  Str.get_string('edithead', 'local_mooccourses');\n            }\n            if(args.act == 1){\n                 var head =  Str.get_string('create_newstudent', 'local_mooccourses');\n            }\n            return head.then(function(title) {\n             \n                return ModalFactory.create({\n                 type: ModalFactory.types.DEFAULT,\n                title: title,             \n                body: this.getBody(),\n                footer: this.getFooter()\n                });\n            }.bind(this)).then(function(modal) {\n                \n                      self.modal = modal;\n               \n                self.modal.getRoot().addClass('openLMStransition local_school');\n                // Forms are big, we want a big modal.\n                self.modal.setLarge();\n     \n                // We want to reset the form every time it is opened.\n                this.modal.getRoot().on(ModalEvents.hidden, function() {\n                // this.modal.getRoot().animate({\"right\":\"-85%\"}, 500);\n                // setTimeout(function(){\n                    modal.destroy();\n                // }, 1000);\n            }.bind(this));\n            this.modal.getFooter().find('[data-action=\"save\"]').on('click', this.submitForm.bind(this));\n            this.modal.getFooter().find('[data-action=\"cancel\"]').on('click', function() {\n                window.location.href =  window.location.href;\n            });\n            this.modal.getFooter().find('[data-action=\"skip\"]').on('click', function() {\n                self.args.form_status = self.args.form_status + 1;\n                 // OL-1042 Add Target Audience to curriculums//\n                \n                var data = self.getBody();\n              \n                modal.setBody(data);\n            });\n\n            this.modal.getRoot().on('submit', 'form', function(form) {\n                self.submitFormAjax(form, self.args);\n            });\n            this.modal.show();\n            this.modal.getRoot().animate({\"right\":\"0%\"}, 500);\n            $(\".close\").click(function(){\n                window.location.href =  window.location.href;\n            });\n            return this.modal;\n            }.bind(this));       \n        \n        \n        // });\n        \n    };\n \n    /**\n     * @method getBody\n     * @private\n     * @return {Promise}\n     */\n    NewMooccourse.prototype.getBody = function(formdata) {\n        if (typeof formdata === \"undefined\") {\n            formdata = {};\n        }\n        // Get the content of the modal.\n       this.args['jsonformdata'] = JSON.stringify(formdata);\n       if(this.args.act){\n\n        return Fragment.loadFragment('local_mooccourses', 'enroluser', this.args.context, this.args);\n\n       }else{\n        if(this.args.courseid){\n        return Fragment.loadFragment('local_mooccourses', 'selectcategory', this.args.contextid, this.args);\n       }else{\n        return Fragment.loadFragment('local_mooccourses', 'selectcategory', this.contextid, this.args);\n       }\n      }\n    };\n      NewMooccourse.prototype.getFooter = function() {\n      \n        if(this.args.course == 3){\n             $footer = '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Update</button>&nbsp;';\n        }\n        else if(this.args.act == 1){\n\n            $footer = '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Assign</button>&nbsp;';\n        }\n        else{\n        $footer = '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Create</button>&nbsp;';\n        }\n        if (this.form_status == 0) {\n            $style = 'style=\"display:none;\"';\n            $footer += '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"skip\" ' + $style + '>Skip</button>&nbsp;';\n        }\n        $footer += '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">Cancel</button>';\n        return $footer;\n    };\n \n    /**\n     * @method handleFormSubmissionResponse\n     * @private\n     * @return {Promise}\n     */\n    NewMooccourse.prototype.handleFormSubmissionResponse = function() {\n        this.modal.hide();\n        // We could trigger an event instead.\n        // Yuk.\n        Y.use('moodle-core-formchangechecker', function() {\n            M.core_formchangechecker.reset_form_dirty_state();\n        });\n        document.location.reload();\n    };\n \n    /**\n     * @method handleFormSubmissionFailure\n     * @private\n     * @return {Promise}\n     */\n    NewMooccourse.prototype.handleFormSubmissionFailure = function(data) {\n        // Oh noes! Epic fail :(\n        // Ah wait - this is normal. We need to re-display the form with errors!\n        this.modal.setBody(this.getBody(data));\n    };\n \n    /**\n     * Private method\n     *\n     * @method submitFormAjax\n     * @private\n     * @param {Event} e Form submission event.\n     */\n    NewMooccourse.prototype.submitFormAjax = function(e) {\n        // We don't want to do a real form submission.\n        e.preventDefault();\n       \n        // Convert all the form elements values to a serialised string.\n        var formData = this.modal.getRoot().find('form').serialize();\n\n        // Now we can continue...\n       //console.log(JSON.stringify(formData));\n    \n       if(this.args['cid']){\n         Ajax.call([{\n            methodname: 'local_mooccourses_submit_create_mooccourse_form',\n            args: {contextid: this.contextid,courseid:this.args['courseid'],parentcourseid: this.args['cid'] ,jsonformdata: JSON.stringify(formData)},\n            done: this.handleFormSubmissionResponse.bind(this, formData),\n            fail: this.handleFormSubmissionFailure.bind(this, formData)\n        }]);\n       }\n       else if(this.args['act'] == 1){\n      \n             Ajax.call([{\n            methodname: 'local_mooccourses_submit_enrolusers_form',\n            args: {contextid: this.contextid,courseid:this.args['courseid'],jsonformdata: JSON.stringify(formData)},\n            done: this.handleFormSubmissionResponse.bind(this, formData),\n            fail: this.handleFormSubmissionFailure.bind(this, formData)\n        }]);\n       }\n       else{\n      \n         Ajax.call([{\n            methodname: 'local_mooccourses_submit_edit_mooccourse_form',\n            args: {contextid: this.args['contextid'],courseid:this.args['courseid'] ,forpurchaseindividually:this.args['forpurchaseindividually'],jsonformdata: JSON.stringify(formData)},\n            done: this.handleFormSubmissionResponse.bind(this, formData),\n            fail: this.handleFormSubmissionFailure.bind(this, formData)\n        }]);\n       }\n       \n    };\n \n    /**\n     * This triggers a form submission, so that any mform elements can do final tricks before the form submission is processed.\n     *\n     * @method submitForm\n     * @param {Event} e Form submission event.\n     * @private\n     */\n    NewMooccourse.prototype.submitForm = function(e) {\n        e.preventDefault();\n        var self = this;\n        self.modal.getRoot().find('form').submit();\n    };\n    return  {\n                // Public variables and functions.\n                /**\n                 * Attach event listeners to initialise this module.\n                 *\n                 * @method init\n                 * @param {string} selector The CSS selector used to find nodes that will trigger this module.\n                 * @param {int} contextid The contextid for the course.\n                 * @return {Promise}\n                 */\n                init: function(args) {\n                  \n                   \n                    return new NewMooccourse(args);\n                },\n                load: function(){\n\n                $(document).on('change', '#id_open_costcenterid', function() {\n                var costcentervalue = $(this).find(\"option:selected\").val();\n                if (costcentervalue !== null) {\n                    $.ajax({\n                        method: \"GET\",\n                        dataType: \"json\",\n                        url: M.cfg.wwwroot + \"/local/curriculum/ajax.php?action=departmentlist&costcenter=\"+costcentervalue,\n                        success: function(data){\n                            var template = '<option value = 0>Select Departments</option>';\n\n                              $.each( data.data, function( index, value) {\n                                   template +=  '<option value = ' + value.id + ' >' +value.fullname + '</option>';\n                              });\n                              // alert(template);\n                            $(\"#id_category\").html(template);\n                        }\n                    });\n                }\n            });\n\n\n        \n                },\n                mooccoursesList: function(args) {\n                var self = this;\n                $.ajax({\n                type: \"POST\",\n               //  url:   M.cfg.wwwroot + '/local/mooccourses/ajax.php',\n          //      url:   M.cfg.wwwroot + '/local/mooccourses/ajax.php',\n                data: {action:'mooccoursesList',\n                    sesskey: M.cfg.sesskey\n                },\n                success: function(returndata) {\n                    //Var returned_data is ONLY available inside this fn!\n                    ModalFactory.create({\n                        title: Str.get_string('selecttemplate', 'local_mooccourses'),\n                        body: returndata\n                      }).done(function(modal) {\n                        // Do what you want with your new modal.\n                        // modal.show();\n                       // curriculum.chlidprogramsDatatable(args);\n                         modal.setLarge();\n                         modal.getRoot().addClass('openLMStransition');\n                            modal.getRoot().animate({\"right\":\"0%\"}, 500);\n                            modal.getRoot().on(ModalEvents.hidden, function() {\n                            // modal.getRoot().animate({\"right\":\"-85%\"}, 500);\n                                    // setTimeout(function(){\n                                    modal.destroy();\n                                // }, 1000);\n                            }.bind(this));\n                            /*$(\".close\").click(function(){\n                                modal.hide();\n                                modal.destroy();\n                            });*/\n                            // We want to reset the form every time it is opened.\n                            modal.getRoot().on(ModalEvents.cancel, function() {\n                                // self.modal.setBody('');\n                                modal.hide();\n                                modal.destroy();\n                            }.bind(this));\n                            modal.show();\n                            self.dataTableshow();\n                         //return modal;\n                      });\n                }\n            });\n        },\n         \n    };\n});\n"],"file":"newmooccourses.min.js"}