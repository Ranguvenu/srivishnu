define ("block_learnerscript/smartfilter",["jquery","block_learnerscript/ajax","block_learnerscript/reportwidget","block_learnerscript/report","block_learnerscript/flatpickr","core/str","block_learnerscript/jquery.serialize-object"],function(a,b,c,d,e,f){var g=a(".basicparamsform #id_filter_courses"),h=a(".basicparamsform #id_filter_users"),i=a(".basicparamsform #id_filter_activities"),i=a(".basicparamsform #id_filter_activities"),j=a(".basicparamsform #id_filter_faculty"),k=a(".filterform #id_filter_courses"),l=a(".filterform #id_filter_users"),m=a(".filterform #id_filter_activities"),m=a(".filterform #id_filter_activities"),n=a(".filterform #id_filter_faculty"),o=a(".durationfilter"),p=a(".reportcontenttype");return smartfilter={SelectDuration:function(){var b=this;o.on("click",function(c){c.stopImmediatePropagation();var d=a(this).data("blockinstance"),e=a(this).data("reportid"),f=a(this).data("reporttype"),g=a(this).data("duration");b.DurationFilter(g,"true",e,d,f);if(0<a("#reportcontainer"+d).html().length){a("#plotreportcontainer"+d).data("reporttype",f)}else{a("#reportcontainer"+d).data("reporttype",f)}a("#datefilter"+d).trigger("click")})},ReportContenttypes:function(){this;p.on("click",function(b){b.stopImmediatePropagation();a(".navbar-collapse").collapse("hide");var c=a(this).data("blockinstance"),d=a(this).data("reportid"),e=a(this).data("reporttype");require(["block_learnerscript/reportwidget"],function(a){a.CreateDashboardwidget({reporttype:e,container:"#reporttype_"+c,reportid:d,instanceid:c,reportdashboard:1,selectreport:!0})});if(0<a("#reportcontainer"+c).html().length){a("#plotreportcontainer"+c).data("reporttype",e)}else{a("#reportcontainer"+c).data("reporttype",e)}a("#reportcontenttypes"+c).trigger("click")})},DurationFilter:function(b,c,d=null,g=null,h=null){var i=new Date,j=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate(),k="";if(!1==c){g=""}if("clear"!==b){a("#ls_fenddate"+g).val(i.getTime()/1e3);switch(b){case"week":k=new Date(i.getFullYear(),i.getMonth(),i.getDate()-7);break;case"month":k=new Date(i.getFullYear(),i.getMonth()-1,i.getDate());break;case"year":k=new Date(i.getFullYear()-1,i.getMonth(),i.getDate());break;case"custom":var l=a("input[name=\"reportid\"]").val();a("#customrange"+g).show();e("#customrange"+g,{mode:"range",onOpen:function(a,b,c){c.clear()},onClose:function(b,d){a("#ls_fstartdate"+g).val(b[0].getTime()/1e3);a("#ls_fenddate"+g).val(b[1].getTime()/1e3+86400);require(["block_learnerscript/report"],function(a){a.CreateReportPage({reportid:l,instanceid:l,reportdashboard:c})});a("#durtiontext"+g).text(d)}});break;default:a("#ls_fstartdate"+g).val(0);break;}if(""!=k){a("#ls_fstartdate"+g).val(k.getTime()/1e3)}}else{a("#ls_fenddate"+g).val("");a("#ls_fstartdate"+g).val("")}if("custom"!==b){if(!1!=c){require(["block_learnerscript/reportwidget"],function(a){a.CreateDashboardwidget({reportid:d,reporttype:h,instanceid:g})});f.get_string(b,"block_reportdashboard").then(function(b){a("#durtiontext"+g).text(b)})}else{var l=a("input[name=\"reportid\"]").val();require(["block_learnerscript/report"],function(a){a.CreateReportPage({reportid:l,instanceid:l,reportdashboard:c})})}a("#customrange"+g).val("");a("#customrange"+g).hide()}if(!0!=c){var l=a("input[name=\"reportid\"]").val();a(".plotgraphcontainer").removeClass("show").addClass("hide");a("#plotreportcontainer"+l).html("")}},FilterData:function(b){var c=a(".filterform"+b).serializeObject();a.urlParam=function(a){var b=new RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href);if(null===b||" "==b){return null}else{return b[1]||0}};var d=a.urlParam("dashboardurl");if("Course"==d){var e=a(".report_courses").val();c.filter_courses=e;var f=a(".dashboardcollege").val();c.filter_college=f;var g=a(".dashboarddept").val();c.filter_department=g}else if("VishnuLearning"==d){var f=a(".dashboardcollege").val();c.filter_college=f;var g=a(".dashboarddept").val();c.filter_department=g}else{var h=a("#id_filter_college").val();c.filter_college=h;var i=a("#id_filter_department").val();c.filter_department=i;var i=a("#id_filter_department").val();c.filter_department=i;var j=a("#id_filter_program").val();c.filter_program=j;var k=a("#id_filter_faculty").val();c.filter_faculty=k}return c},BasicparamsData:function(b){var c=a(".basicparamsform"+b).serializeObject();return c},CourseData:function(a){var b=!1;if(0<i.length||0<m.length){if(0<i.length){b=!0}if(0<a.courseid){this.CourseActivities({courseid:a.courseid,firstelementactive:b,activityid:a.filterrequests.filter_activities})}}if(0<h.length||0<l.length){if(0<h.length){b=!0}}if(0<j.length||0<n.length){if(0<j.length){b=!0}if(0<a.courseid){this.CourseFaculties({courseid:a.courseid,firstelementactive:b,facultyid:a.filterrequests.filter_faculty})}}},categoryCourses:function(c){var d=a("#id_filter_coursecategories").find(":selected").val();if(0<d){var e=b.call({args:{action:"categorycourses",basicparam:!0,reporttype:c.reporttype,categoryid:c.categoryid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});e.done(function(b){var c="";a.each(b,function(a,b){c+="<option value = "+a+">"+b+"</option>"});a("#id_filter_courses").html(c)})}},CourseActivities:function(c){var d=c.element||a("#id_filter_activities");activityid=parseInt(c.activityid)||0;d.val();d.find("option").remove().end().append("<option value=0>Select Activity</option>");if(0<=c.courseid){var e=b.call({args:{action:"courseactivities",basicparam:!0,courseid:c.courseid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});e.done(function(b){a.each(b,function(b,c){b=parseInt(b);if(0==b){return!0}if(b!=activityid){d.append(a("<option></option>").attr("value",b).text(c))}else{d.append(a("<option></option>").attr("value",b).attr("selected","selected").text(c))}});var e=a(".basicparamsform #id_filter_activities").find(":selected").val();if(0==e||null==e){a(".basicparamsform #id_filter_activities").val(a(".basicparamsform #id_filter_activities option:eq(1)").val())}var f=d.parents(".basicparamsform").length;if(0<f&&c.onloadtrigger){a(".basicparamsform #id_filter_apply").trigger("click")}})}},CourseFaculties:function(c){var d=c.element||a("#id_filter_faculty");facultyid=parseInt(c.facultyid)||0;d.val();d.find("option").remove().end().append("<option value=0>Select Faculty</option>");if(0<=c.courseid){var e=b.call({args:{action:"coursefaculties",basicparam:!0,courseid:c.courseid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});e.done(function(b){a.each(b,function(b,c){b=parseInt(b);if(0==b){return!0}if(b!=facultyid){d.append(a("<option></option>").attr("value",b).text(c))}else{d.append(a("<option></option>").attr("value",b).attr("selected","selected").text(c))}});var e=a(".basicparamsform #id_filter_faculty").find(":selected").val();if(0==e||null==e){a(".basicparamsform #id_filter_faculty").val(a(".basicparamsform #id_filter_faculty option:eq(1)").val())}var f=d.parents(".basicparamsform").length;if(0<f&&c.onloadtrigger){a(".basicparamsform #id_filter_apply").trigger("click")}})}},UserCourses:function(c){var d=a("#id_filter_courses").find(":selected").val();a("#id_filter_courses").find("option").remove().end().append("<option value=\"\">Select Course</option>");if(0<=c.userid){var e=b.call({args:{action:"usercourses",basicparam:!0,userid:c.userid,reporttype:c.reporttype,reportid:c.reportid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});e.done(function(b){a.each(b,function(e,f){if(0==e){return!0}if(e==Object.keys(b)[0]&&1==c.firstelementactive||e==d&&1==c.firstelementactive){a("#id_filter_courses").append(a("<option></option>").attr("value",e).attr("selected","selected").text(f));if("undefined"!=typeof c.triggercourseactivities&&!0==c.triggercourseactivities){smartfilter.CourseActivities({courseid:e})}}else{a("#id_filter_courses").append(a("<option></option>").attr("value",e).text(f))}})})}},EnrolledUsers:function(c){var d=c.element||a("#id_filter_users"),e=d.val();d.find("option").remove().end().append("<option value=\"\">Select User</option>");var f=b.call({args:{action:"enrolledusers",basicparam:!0,reportid:c.reportid,courseid:c.courseid,reporttype:c.reporttype,component:c.components},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});f.done(function(b){a.each(b,function(b,c){if(0==b){return!0}if(b!=e){d.append(a("<option></option>").attr("value",b).text(c))}else{d.append(a("<option></option>").attr("value",b).attr("selected","selected").text(c))}});if(!!b.hasOwnProperty(e)){d.select2("val","");var f=d.parents(".basicparamsform").length;if(0<f&&c.onloadtrigger){a(".basicparamsform #id_filter_apply").trigger("click")}}})},CohortUsers:function(c){var d=a("#id_filter_cohort").find(":selected").val();if(0<d){var e=b.call({args:{action:"cohortusers",basicparam:!0,reporttype:c.reporttype,categoryid:c.cohortid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});e.done(function(b){var c="";a.each(b,function(a,b){c+="<option value = "+a+">"+b+"</option>"});a("#id_filter_users").html(c)})}},Coldepartments:function(c){var d=a("#id_filter_college").find(":selected").val();if(0<d){var e=b.call({args:{action:"coldepartments",basicparam:!0,reporttype:c.reporttype,collegeid:c.collegeid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});e.done(function(b){var c="";a.each(b,function(a,b){c+="<option value = "+a+">"+b+"</option>"});a("#id_filter_department").html(c)})}},ColDeptPrograms:function(c){var d=a("#id_filter_college").find(":selected").val(),e=a("#id_filter_department").find(":selected").val();if(0<d){var f=b.call({args:{action:"coldeptprograms",basicparam:!0,reporttype:c.reporttype,collegeid:c.collegeid,departmentid:c.departmentid},url:M.cfg.wwwroot+"/blocks/learnerscript/ajax.php"});f.done(function(b){var c="";a.each(b,function(a,b){c+="<option value = "+a+">"+b+"</option>"});a("#id_filter_program").html(c)})}}}});
//# sourceMappingURL=smartfilter.min.js.map
